namespace = fascism_events

# 국가(國歌)
fascism_events.8 = {
	type = country_event
	title = fascism_events.8.t
	desc = fascism_events.8.d
	placement = scope:anthem_state

	duration = 3

	event_image = {
		video = "gfx/event_pictures/unspecific_world_fair.bk2"
	}

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/world_fair"

	flavor = {
		# 첫 번째 소절
		random_valid = {
			# 한국
			triggered_desc = {
				trigger = {
					exists = c:KOR
					this = c:KOR
					c:KOR = { has_law = law_type:law_monarchy }
				}
				desc = first_line_kor_monarchy
			}
			triggered_desc = {
				trigger = {
					exists = c:KOR
					this = c:KOR
					c:KOR = {
						NOT = { has_law = law_type:law_monarchy }
					}
				}
				desc = first_line_kor_republic
			}

			# 나머지 국가
			triggered_desc = {
				trigger = {
					var:first_and_second_lines = 1
				}
				desc = first_line_rhyme_a_1
			}
			triggered_desc = {
				trigger = {
					var:first_and_second_lines = 1
				}
				desc = first_line_rhyme_a_2
			}
			triggered_desc = {
				trigger = {
					var:first_and_second_lines = 2
				}
				desc = first_line_rhyme_b_1
			}
			triggered_desc = {
				trigger = {
					var:first_and_second_lines = 2
				}
				desc = first_line_rhyme_b_2
			}
		}

		# 두 번째 소절
		random_valid = {
			# 한국
			triggered_desc = {
				trigger = {
					exists = c:KOR
					this = c:KOR
					c:KOR = { has_law = law_type:law_monarchy }
				}
				desc = second_line_kor_monarchy
			}
			triggered_desc = {
				trigger = {
					exists = c:KOR
					this = c:KOR
					c:KOR = {
						NOT = { has_law = law_type:law_monarchy }
					}
				}
				desc = second_line_kor_republic
			}

			# 나머지 국가
			triggered_desc = {
				trigger = {
					var:first_and_second_lines = 1
				}
				desc = second_line_rhyme_a_1
			}
			triggered_desc = {
				trigger = {
					var:first_and_second_lines = 1
				}
				desc = second_line_rhyme_a_2
			}
			triggered_desc = {
				trigger = {
					var:first_and_second_lines = 2
				}
				desc = second_line_rhyme_b_1
			}
			triggered_desc = {
				trigger = {
					var:first_and_second_lines = 2
				}
				desc = second_line_rhyme_b_2
			}
		}

		# 세 번째 소절
		random_valid = {
			# 한국
			triggered_desc = {
				trigger = {
					exists = c:KOR
					this = c:KOR
					c:KOR = { has_law = law_type:law_monarchy }
				}
				desc = third_line_kor_monarchy
			}
			triggered_desc = {
				trigger = {
					exists = c:KOR
					this = c:KOR
					c:KOR = {
						NOT = { has_law = law_type:law_monarchy }
					}
				}
				desc = third_line_kor_republic
			}

			# 나머지 국가
			triggered_desc = {
				trigger = {
					var:third_and_fourth_lines = 1
				}
				desc = third_line_rhyme_a_1
			}
			triggered_desc = {
				trigger = {
					var:third_and_fourth_lines = 1
				}
				desc = third_line_rhyme_a_2
			}
			triggered_desc = {
				trigger = {
					var:third_and_fourth_lines = 2
				}
				desc = third_line_rhyme_b_1
			}
			triggered_desc = {
				trigger = {
					var:third_and_fourth_lines = 2
				}
				desc = third_line_rhyme_b_2
			}
		}

		# 네 번째 소절
		random_valid = {
			# 한국
			triggered_desc = {
				trigger = {
					exists = c:KOR
					this = c:KOR
					c:KOR = { has_law = law_type:law_monarchy }
				}
				desc = fourth_line_kor_monarchy
			}
			triggered_desc = {
				trigger = {
					exists = c:KOR
					this = c:KOR
					c:KOR = {
						NOT = { has_law = law_type:law_monarchy }
					}
				}
				desc = fourth_line_kor_republic
			}

			# 나머지 국가
			triggered_desc = {
				trigger = {
					var:third_and_fourth_lines = 1
				}
				desc = fourth_line_rhyme_a_1
			}
			triggered_desc = {
				trigger = {
					var:third_and_fourth_lines = 1
				}
				desc = fourth_line_rhyme_a_2
			}
			triggered_desc = {
				trigger = {
					var:third_and_fourth_lines = 2
				}
				desc = fourth_line_rhyme_b_1
			}
			triggered_desc = {
				trigger = {
					var:third_and_fourth_lines = 2
				}
				desc = fourth_line_rhyme_b_2
			}
		}

		# 다섯 번째 소절
		random_valid = {
			# 한국
			triggered_desc = {
				trigger = {
					exists = c:KOR
					this = c:KOR
					c:KOR = { has_law = law_type:law_monarchy }
				}
				desc = fifth_line_kor_monarchy
			}
		}

		# 여섯 번째 소절
		random_valid = {
			# 한국
			triggered_desc = {
				trigger = {
					exists = c:KOR
					this = c:KOR
					c:KOR = { has_law = law_type:law_monarchy }
				}
				desc = sixth_line_kor_monarchy
			}
		}
	}

	trigger = {
		has_technology_researched = nationalism
		NOT = { has_variable = national_anthem_var }
		any_scope_state = {
			is_incorporated = yes
			any_scope_building = {
				is_building_type = building_arts_academy
			}
		}
	}

	immediate = {
		# 지정 국가가 있는 나라일 경우
		if = {
			limit = {
				exists = c:KOR
				this = c:KOR
			}

			set_variable = {
				name = first_and_second_lines
				value = -1
			}
			set_variable = {
				name = third_and_fourth_lines
				value = -1
			}
		}
		# 지정 국가가 없는 나라일 경우
		else = {
			random_list = {
				50 = {
					set_variable = {
						name = first_and_second_lines
						value = 1
					}
				}
				50 = {
					set_variable = {
						name = first_and_second_lines
						value = 2
					}
				}
			}
			random_list = {
				50 = {
					set_variable = {
						name = third_and_fourth_lines
						value = 1
					}
				}
				50 = {
					set_variable = {
						name = third_and_fourth_lines
						value = 2
					}
				}
			}
		}

		if = {
			limit = {
				any_country = {
					has_diplomatic_pact = {
						who = ROOT
						type = rivalry
					}
				}
			}
			random_country = {
				limit = {
					has_diplomatic_pact = {
						who = ROOT
						type = rivalry
					}
				}
				save_scope_as = rival_country
			}
		}
		# # 문법 오류 의심됨, 비활성화함
		# # 사유: else_if문에 '직접' 연결된 limit문이 없음
		# 패독 새끼들 코딩 수준 ㅋㅋㅋㅋ
		else_if = {
			limit = {
				any_country = {
					NOT = { this = ROOT }
					NOT = { is_country_type = decentralized }
					NOT = { is_country_type = unrecognized }
					any_neighbouring_state = { owner = ROOT }
					relations:root < relations_threshold:neutral
				}
			}
			random_country = {
				limit = {
					NOT = { this = ROOT }
					NOT = { is_country_type = decentralized }
					NOT = { is_country_type = unrecognized }
					any_neighbouring_state = { owner = ROOT }
					relations:root < relations_threshold:neutral
				}
				save_scope_as = rival_country
			}
		}
		else_if = {
			limit = {
				any_country = {
					NOT = { this = ROOT }
					NOT = { is_country_type = decentralized }
					NOT = { is_country_type = unrecognized }
					any_neighbouring_state = { owner = ROOT }
					relations:root < relations_threshold:neutral
				}
			}
			random_country = {
				limit = {
					NOT = { this = ROOT }
					NOT = { is_country_type = decentralized }
					NOT = { is_country_type = unrecognized }
					relations:root < relations_threshold:neutral
				}
				save_scope_as = rival_country
			}
		}
		################## 여기까지 변경
		else = {
			random_country = {
				limit = {
					NOT = { this = ROOT }
				}
				save_scope_as = rival_country
			}
		}
		random_scope_state = {
			limit = {
				is_incorporated = yes
				any_scope_building = {
					is_building_type = building_arts_academy
				}
			}
			save_scope_as = anthem_state
			random_scope_building = {
				limit = {
					is_building_type = building_arts_academy
				}
				save_scope_as = anthem_building
			}
		}
		set_variable = national_anthem_var
	}

	option = {
		name = fascism_events.8.a
		add_modifier = {
			name = national_anthem_modifier
			months = normal_modifier_time
		}
	}
}
